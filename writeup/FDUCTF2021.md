## FDUCTF 2021

> By Lemonaire

> 声明：由于之前清理了大量的桌面临时文件（形如 test.* 这样的文件），其中包括了几乎所有之前写的脚本，加上最近实在太忙了，没空重写，所以以下能给脚本的我尽量给，给不了的就……
>

### Crypto

#### BabyRSA

额……具体我忘了，应该是首先算一下欧拉函数 phi，因为 n 是 2**1024，所以可以用 phi(p^k) = p^k - p^(k-1) 计算，然后求乘法逆元，再 long_to_bytes。以下是从回收站里翻出来的脚本。

```python
from Crypto.Util.number import *
# from secret import flag
import gmpy2

n=2**1024
e=65537
# m=bytes_to_long(flag)
# c=pow(m,e,n)
# print(c)
#98710114935284696266727187099974304915197330259272688276752009544494890794011845947207535135621221728554983292075279363326530470887005280108304064858795643910517493912505786063549355563638508775960293670872216617616553808345157867436238066114955363541580189011576137409639942086089783269849382676031779988861
phi = 2**1023
d = gmpy2.invert(e, phi)
res = gmpy2.powmod(98710114935284696266727187099974304915197330259272688276752009544494890794011845947207535135621221728554983292075279363326530470887005280108304064858795643910517493912505786063549355563638508775960293670872216617616553808345157867436238066114955363541580189011576137409639942086089783269849382676031779988861,d,n)

print(long_to_bytes(res))
```

#### BabyHash

在 ascii 字符集里面爆破一下，拿到所有集合以后一个个 ctrl + F（？我知道这很好笑，但这很快！

因为这个还挺简单的，现场写一下脚本，不保证能跑，大概就这个意思。

```python
for i in range(128):
	print(hashlib.sha256(chr(i).encode()).hexdigest()， chr(i))
    # 本 py 苦手忘记怎么把数字转成字符了，反正就是这个意思。
```

#### EasyXOR

循环了五遍与后面一位的异或，所以可以通过已知的 FDUCTF 倒推，最后一位的加密结果是明文最后一位，第一位，第五位，第六位（大概，也可能不是，但大差不差，就是那么几位）异或产生的，以此类推。回收站没找到脚本……

#### BabyRandom

输入 0 即可，之后所有的位运算结果都是 0，避开随机数。



### Misc

#### photo

改成 txt 文件到最后直接获得。

#### key2

应该是个伪加密，但 7z 直接解压缩就行了 hhh

#### 实验报告

改成 zip，解压得到。



### Web

#### 爬图小助手v1

输入链接为 127.0.0.1/flag

#### 爬图小助手v2

找一个短链接生成器，重定向到 127.0.0.1/flag，应该需要全英文的，目测似乎是过滤了数字。

#### IP-SSTI

做了几次测试，发现是 Jinja2 注入，利用 XFF。注入语句过长且过于复杂，也并没有保存，大概形如 `{{''.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__['__builtins__']['eval']("__import__('os').popen('ls').read()")}}  ` 这个样子（这个是网上随便找的）。先扫一遍看哪些包括了 os 模块，然后找一个有 os 模块的扫目录，最后读文件。

#### easy_sql

~~这道题可能放错地方了，建议放 Misc，考验选手的信息搜集能力。（找 wp 能力）~~

百度搜索 `ctf web comment` 可得详细结果，不太一样的可能是爆破密码是 3 * 26 个字母（爆破脚本丢了）， .git 泄露的源码直接放在了 hint.txt 里，以及 bash history 也没有得到结果。

这里随便放一个链接，其实参考了好几篇。https://www.cnblogs.com/remon535/p/12821405.html



### Binary

#### login

IDA 一下，得到用户名 `adm1n`，然后 gdb 打个断点，得到密码，具体是啥我忘了。